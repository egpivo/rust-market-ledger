<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rust Market Ledger - Consensus Comparison</title>
    <style>
        :root {
            color-scheme: light;
            --bg: #f4f7fb;
            --card: #ffffff;
            --text: #1f2937;
            --muted: #6b7280;
            --accent: #2563eb;
            --accent-weak: #dbeafe;
            --border: #e5e7eb;
            --success: #16a34a;
            --warning-bg: #fff7ed;
            --warning-border: #fdba74;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--bg);
            padding: 32px 20px 40px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 28px;
        }

        .hero {
            background: linear-gradient(135deg, #0f172a, #1e3a8a);
            color: #f8fafc;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 20px 35px rgba(15, 23, 42, 0.2);
        }

        .hero h1 {
            font-size: 2.6rem;
            margin-bottom: 12px;
        }

        .hero p {
            color: #cbd5f5;
            font-size: 1.1rem;
            max-width: 720px;
        }

        .hero-actions {
            margin-top: 24px;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.85rem;
            letter-spacing: 0.02em;
        }

        .section {
            background: var(--card);
            padding: 28px;
            border-radius: 14px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
        }

        h2 {
            font-size: 1.6rem;
            margin-bottom: 16px;
        }

        h3 {
            font-size: 1.2rem;
            margin-bottom: 12px;
        }

        .subtext {
            color: var(--muted);
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 0;
        }

        .tab {
            padding: 12px 20px;
            border-radius: 10px 10px 0 0;
            border: 1px solid var(--border);
            border-bottom: none;
            background: #f8fafc;
            color: var(--muted);
            cursor: pointer;
            font-weight: 500;
        }

        .tab.active {
            background: var(--card);
            color: var(--accent);
            border-color: var(--border);
            border-bottom: 2px solid var(--card);
            margin-bottom: -2px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 14px;
            margin: 20px 0;
        }

        .param-item {
            border: 1px solid var(--border);
            padding: 14px;
            border-radius: 10px;
            background: #f9fafb;
        }

        .param-item strong {
            display: block;
            margin-bottom: 6px;
        }

        .param-item span {
            color: var(--success);
            font-family: "JetBrains Mono", "Courier New", monospace;
        }

        .data-note {
            background: var(--warning-bg);
            border: 1px solid var(--warning-border);
            padding: 14px;
            border-radius: 10px;
            color: #7c2d12;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 12px;
            overflow: hidden;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: #1e3a8a;
            color: #fff;
        }

        tr:nth-child(even) {
            background: #f9fafb;
        }

        .metric {
            font-weight: 600;
        }

        .value {
            font-family: "JetBrains Mono", "Courier New", monospace;
            color: var(--success);
        }

        .trilemma-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .trilemma-card {
            border: 1px solid var(--border);
            background: #f8fafc;
            padding: 16px;
            border-radius: 12px;
        }

        .trilemma-card h4 {
            margin-bottom: 12px;
        }

        .score-bar {
            height: 10px;
            background: #e5e7eb;
            border-radius: 999px;
            margin: 6px 0 12px;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #60a5fa, #2563eb);
            border-radius: 999px;
        }

        footer {
            text-align: center;
            color: var(--muted);
            font-size: 0.9rem;
        }

        a {
            color: var(--accent);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        ol, ul {
            margin-left: 20px;
            line-height: 2;
        }

        .card {
            background: #f9fafb;
            border: 1px solid var(--border);
            padding: 18px;
            border-radius: 12px;
            margin: 16px 0;
        }

        @media (max-width: 720px) {
            .hero {
                padding: 28px;
            }

            .hero h1 {
                font-size: 2.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <section class="hero">
            <h1>Rust Market Ledger</h1>
            <p>Consensus algorithm comparison with simulated market data.</p>
        </section>

        <section class="section">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('goal')">Goal & Metrics</button>
                <button class="tab" onclick="switchTab('setup')">Data and Env Setups</button>
                <button class="tab" onclick="switchTab('results')">Results</button>
            </div>

            <div id="goalTab" class="tab-content active">
                <h2>Goal</h2>
                <p class="subtext">Compare consensus algorithms using the same test blocks to understand performance trade-offs and trilemma characteristics.</p>
                <div class="data-note" style="margin-top: 20px;">
                    <strong>Experimental Context:</strong> This is a conceptual demonstration using simulated data and simplified consensus implementations. Metric values are illustrative and reflect simulator characteristics rather than production system performance. See "Data and Env Setups" tab for simulation details.
                </div>

                <h2 style="margin-top: 32px;">Metric Definitions</h2>
                <div class="card">
                    <ul>
                        <li><strong>Latency (ms):</strong> Time from block proposal to consensus result (average across all blocks)</li>
                        <li><strong>Throughput (blocks/sec):</strong> Total blocks processed / total execution time</li>
                        <li><strong>Commit Rate (%):</strong> (Committed blocks / Total blocks) &times; 100</li>
                        <li><strong>Error Rate (%):</strong> (Blocks with errors / Total blocks) &times; 100</li>
                        <li><strong>Trilemma Scores:</strong> Qualitative assessment (1-5 scale) based on algorithm characteristics</li>
                    </ul>
                </div>

                <h2 style="margin-top: 32px;">Consensus Algorithms</h2>
                <div class="card">
                    <ul>
                        <li><strong>PBFT</strong> - Practical Byzantine Fault Tolerance (BFT, requires majority voting: 2f+1 out of 3f+1)</li>
                        <li><strong>Gossip</strong> - Epidemic/gossip protocol (no majority voting, uses fanout propagation)</li>
                        <li><strong>Eventual</strong> - Time-based commitment (eventual consistency, fixed delay)</li>
                        <li><strong>Quorum-less</strong> - Weighted voting based on reputation (threshold-based, no fixed quorum)</li>
                        <li><strong>Flexible Paxos</strong> - Flexible quorum Paxos (Q1 for phase-1, Q2 for phase-2, Q1 + Q2 > N ensures intersection where N is total nodes)</li>
                    </ul>
                </div>
            </div>

            <div id="setupTab" class="tab-content">
                <h2>Data Simulation Process</h2>
                <div class="card">
                    <ol>
                        <li>Generate 100 test blocks with mock market data (BTC price variations)</li>
                        <li>Each strategy runs on the same 100 blocks for fair comparison</li>
                        <li>Repeat 5 rounds per strategy to calculate mean &plusmn; std dev</li>
                        <li>For each block: measure execution time from <code>strategy.execute(block)</code> start to end</li>
                        <li>Collect metrics: latency, throughput, commit/error rates</li>
                    </ol>
                </div>

                <h2 style="margin-top: 32px;">Sample Market Data</h2>
                <div class="card">
                    <p style="margin-bottom: 12px;">Each block contains simulated BTC price data. Example block structure:</p>
                    <table style="margin-top: 12px;">
                        <thead>
                            <tr>
                                <th>Block Index</th>
                                <th>BTC Price (USD)</th>
                                <th>Source</th>
                                <th>Timestamp</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="value">1</td>
                                <td class="value">50,100</td>
                                <td>CoinGecko</td>
                                <td class="value">...</td>
                            </tr>
                            <tr>
                                <td class="value">10</td>
                                <td class="value">51,000</td>
                                <td>CoinGecko</td>
                                <td class="value">...</td>
                            </tr>
                            <tr>
                                <td class="value">50</td>
                                <td class="value">55,000</td>
                                <td>CoinGecko</td>
                                <td class="value">...</td>
                            </tr>
                            <tr>
                                <td class="value">100</td>
                                <td class="value">60,000</td>
                                <td>CoinGecko</td>
                                <td class="value">...</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="margin-top: 16px; color: var(--muted); font-size: 0.9rem;">
                        <strong>Note:</strong> Price pattern: linear increase from 50,000 to 60,000 USD across 100 blocks (simulated for demonstration).
                    </p>
                    
                    <h3 style="margin-top: 24px; margin-bottom: 12px;">BTC Price Time Series</h3>
                    <canvas id="priceChart" style="width: 100%; height: 300px; margin-top: 12px;"></canvas>
                </div>

                <h2 style="margin-top: 32px;">Scenario Parameters</h2>
                <div class="params-grid">
                    <div class="param-item">
                        <strong>Blocks per round</strong>
                        <span>100</span>
                    </div>
                    <div class="param-item">
                        <strong>Rounds per strategy</strong>
                        <span>5</span>
                    </div>
                    <div class="param-item">
                        <strong>Total nodes</strong>
                        <span>4</span>
                    </div>
                    <div class="param-item">
                        <strong>PBFT Quorum</strong>
                        <span>3 (2f+1)</span>
                    </div>
                    <div class="param-item">
                        <strong>Gossip Fanout</strong>
                        <span>2</span>
                    </div>
                    <div class="param-item">
                        <strong>Eventual Delay</strong>
                        <span>500ms</span>
                    </div>
                    <div class="param-item">
                        <strong>Quorum-less Threshold</strong>
                        <span>5.0</span>
                    </div>
                    <div class="param-item">
                        <strong>Flexible Paxos Q1/Q2</strong>
                        <span>2/3</span>
                    </div>
                </div>

                <h2 style="margin-top: 32px;">Environment Setup</h2>
                <div class="data-note">
                    <strong>Simulation Environment:</strong>
                    <ul style="margin-top: 10px;">
                        <li>Single machine execution (no actual network)</li>
                        <li>Mock market data (not real feeds)</li>
                        <li>Simplified consensus implementations for demonstration</li>
                        <li>No Byzantine faults or adversarial load tested</li>
                    </ul>
                </div>
            </div>

            <div id="resultsTab" class="tab-content">
                <div class="data-note" style="margin-bottom: 24px;">
                    <strong>Note:</strong> Values shown are illustrative and based on simulator characteristics. For detailed analysis and Medium article context, see experimental design documentation. These metrics demonstrate relative trade-offs between algorithms rather than production benchmarks.
                </div>
                <h2>Performance Metrics</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Strategy</th>
                            <th>Latency (ms)</th>
                            <th>Throughput (blocks/sec)</th>
                            <th>Commit Rate (%)</th>
                            <th>Error Rate (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="metric">PBFT</td>
                            <td class="value">1500.0 &plusmn; 50.0</td>
                            <td class="value">66.67</td>
                            <td class="value">100.0</td>
                            <td class="value">0.0</td>
                        </tr>
                        <tr>
                            <td class="metric">Gossip</td>
                            <td class="value">300.0 &plusmn; 10.0</td>
                            <td class="value">333.33</td>
                            <td class="value">100.0</td>
                            <td class="value">0.0</td>
                        </tr>
                        <tr>
                            <td class="metric">Eventual</td>
                            <td class="value">500.0 &plusmn; 5.0</td>
                            <td class="value">200.0</td>
                            <td class="value">100.0</td>
                            <td class="value">0.0</td>
                        </tr>
                        <tr>
                            <td class="metric">Quorum-less</td>
                            <td class="value">0.5 &plusmn; 0.1</td>
                            <td class="value">2000.0</td>
                            <td class="value">100.0</td>
                            <td class="value">0.0</td>
                        </tr>
                        <tr>
                            <td class="metric">Flexible Paxos</td>
                            <td class="value">800.0 &plusmn; 30.0</td>
                            <td class="value">125.0</td>
                            <td class="value">100.0</td>
                            <td class="value">0.0</td>
                        </tr>
                    </tbody>
                </table>

                <h2 style="margin-top: 32px;">Trilemma Scores (Qualitative)</h2>
                <p class="subtext">Scored from 1 (low) to 5 (high) based on algorithm characteristics.</p>
                <div class="trilemma-scores">
                    <div class="trilemma-card">
                        <h4>PBFT</h4>
                        <p><strong>Decentralization:</strong> 4.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 80%"></div></div>
                        <p><strong>Security:</strong> 5.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 100%"></div></div>
                        <p><strong>Scalability:</strong> 2.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 40%"></div></div>
                    </div>

                    <div class="trilemma-card">
                        <h4>Gossip</h4>
                        <p><strong>Decentralization:</strong> 5.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 100%"></div></div>
                        <p><strong>Security:</strong> 3.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 60%"></div></div>
                        <p><strong>Scalability:</strong> 5.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 100%"></div></div>
                    </div>

                    <div class="trilemma-card">
                        <h4>Eventual</h4>
                        <p><strong>Decentralization:</strong> 4.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 80%"></div></div>
                        <p><strong>Security:</strong> 2.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 40%"></div></div>
                        <p><strong>Scalability:</strong> 4.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 80%"></div></div>
                    </div>

                    <div class="trilemma-card">
                        <h4>Quorum-less</h4>
                        <p><strong>Decentralization:</strong> 4.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 80%"></div></div>
                        <p><strong>Security:</strong> 3.5/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 70%"></div></div>
                        <p><strong>Scalability:</strong> 4.5/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 90%"></div></div>
                    </div>

                    <div class="trilemma-card">
                        <h4>Flexible Paxos</h4>
                        <p><strong>Decentralization:</strong> 4.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 80%"></div></div>
                        <p><strong>Security:</strong> 4.5/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 90%"></div></div>
                        <p><strong>Scalability:</strong> 3.0/5.0</p>
                        <div class="score-bar"><div class="score-fill" style="width: 60%"></div></div>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <p>
                <a href="https://github.com/egpivo/rust-market-ledger">GitHub Repository</a> |
                <a href="https://github.com/egpivo/rust-market-ledger/tree/main/examples">Examples</a>
            </p>
        </footer>
    </div>

    <script>
        function drawPriceChart() {
            const canvas = document.getElementById('priceChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;
            
            const padding = 40;
            const width = canvas.width - 2 * padding;
            const height = canvas.height - 2 * padding;
            
            // Generate price data: linear increase from 50000 to 60000
            const prices = [];
            for (let i = 1; i <= 100; i++) {
                prices.push(50000 + (i * 100));
            }
            
            const minPrice = Math.min(...prices);
            const maxPrice = Math.max(...prices);
            const priceRange = maxPrice - minPrice;
            
            // Draw axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, height + padding);
            ctx.lineTo(width + padding, height + padding);
            ctx.stroke();
            
            // Draw price line
            ctx.strokeStyle = '#2563eb';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i < prices.length; i++) {
                const x = padding + (i / (prices.length - 1)) * width;
                const y = padding + height - ((prices[i] - minPrice) / priceRange) * height;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Draw labels
            ctx.fillStyle = '#6b7280';
            ctx.font = '12px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Block Index', width / 2 + padding, height + padding + 30);
            
            ctx.save();
            ctx.translate(15, height / 2 + padding);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = 'center';
            ctx.fillText('BTC Price (USD)', 0, 0);
            ctx.restore();
            
            // Y-axis labels
            ctx.textAlign = 'right';
            ctx.fillText(minPrice.toLocaleString(), padding - 10, height + padding + 4);
            ctx.fillText(maxPrice.toLocaleString(), padding - 10, padding + 4);
        }
        
        window.addEventListener('load', () => {
            drawPriceChart();
            window.addEventListener('resize', drawPriceChart);
        });
        
        function switchTab(tabName) {
            const tabs = document.querySelectorAll(".tab");
            const contents = document.querySelectorAll(".tab-content");

            tabs.forEach(tab => tab.classList.remove("active"));
            contents.forEach(content => content.classList.remove("active"));

            if (tabName === "goal") {
                document.querySelector(".tab:first-child").classList.add("active");
                document.getElementById("goalTab").classList.add("active");
            } else if (tabName === "setup") {
                document.querySelector(".tab:nth-child(2)").classList.add("active");
                document.getElementById("setupTab").classList.add("active");
            } else {
                document.querySelector(".tab:last-child").classList.add("active");
                document.getElementById("resultsTab").classList.add("active");
            }
        }
    </script>
</body>
</html>
